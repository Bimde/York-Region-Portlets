<body>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <style>
        div#favourties ul#favsBar {
            list-style-type: none;
            padding: 0px;
        }

        div#favourties ul#favsBar li.item {
            display:inline-block;
            margin: 0px;
            padding: 0px;
        }

        div#favourties ul#favsBar li.item div.item {
            display:inline-block;
            background-color: lightgrey;
            margin-left: 5px;
            margin-right: 5px;
            padding: 8px;
            border-radius: 3px;
            border: 1px solid dimgrey;
            line-height: 20px;
            text-align:center;
            height: 20px;
        }

        div#favourties ul#favsBar li.item div.item:hover {
            background-color: gray;
        }

        div#favourties ul#favsBar li.item div.item:active {
            background-color: dimgray;
        }

        div#favourties div#inputForm div span.inputLabel {
            display: inline-block;
            width: 60px;
            text-align: center;
            float: left;
            height: 20px;
            line-height: 20px;
            margin-top: 5px;
            margin-bottom: 5px;
        }

        div#favourties div#inputForm div input.input102 {
            display: inline-block;
            width: 200px;
            margin-top: 5px;
            margin-bottom: 5px;
            float:right;
        }

        div#favourties div#inputForm div.button {
            display: inline-block;
            width: 125px;
            padding: 4px;
            margin-top: 6px;
            margin-bottom: 5px;
            height: 20px;
            border: 1px solid dimgrey;
            text-align: center;
            border-radius: 3px;
            float: right;
        }

        div#favourties div#inputForm div#small.button {
            width: 60px;
            float: left;
        }

        div#favourties div#inputForm div.button:hover {
            background-color: gray;
        }

        div#favourties div#inputForm div.button:active{
            background-color: dimgrey;
        }

        div#favourties div#inputForm {
            display: none;
            background-color: lightgrey;
            padding: 10px;
            border-radius: 4px;
            width: 276px;
            height: 100px;
        }
    </style>

    <script>
        var currentData;
        // USE localStorage['varname'] to save favourites and load all values into array for faster access
        function openAddMenu() {
            document.getElementById("inputForm").style.display = "block";
            document.getElementById("favsBar").style.display = "none";
        }

        function closeAddFavouritesMenu() {
            document.getElementById("inputForm").style.display = "none";
            document.getElementById("favsBar").style.display = "block";
        }

        function clickedFavourite(item) {
            window.open(item.getAttribute("href"),'_blank');
        }

        function removeFromBookmarks(item) {
            removeFromStorage(item);
            item.remove();
        }

        function saveToFile(name, link) {
            if (localStorage && localStorage.getItem("favourites-storage")) {
                var storage = JSON.parse(localStorage.getItem("favourites-storage"));
                storage.favourites.push({"name":name, "link":link});
                currentData = storage;
                localStorage.setItem("favourites-storage", JSON.stringify(storage));
            }
            else {
                var data = {"favourites":[{"name":name, "link":link}]};
                currentData = data;
                localStorage.setItem("favourites-storage", JSON.stringify(data));
            }
            console.log(JSON.parse(localStorage.getItem("favourites-storage")));
        }

        function loadData() {
            if (localStorage && localStorage.getItem("favourites-storage")) {
                var storage = JSON.parse(localStorage.getItem("favourites-storage"));
                for(var i = 0; i < storage.favourites.length; i++) {
                    internalAddToFavourites(storage.favourites[i].name, storage.favourites[i].link, i);
                }
                currentData = storage;
            } else {
                currentData = {"favourites":[]}
            }
        }

        function addToFavourites() {
            var text = document.getElementById("addToListName").value.trim();
            var link = document.getElementById("addToListLink").value.trim();

            if(link === null || link === "") {
                alert("You entered an invalid link! Please re-enter.")
            } else {
                if(text == null || text == "") {
                    text = link;
                }
                var index = currentData.favourites.length;
                internalAddToFavourites(text, link, index);
                saveToFile(text, link);
                closeAddFavouritesMenu();
            }
        }

        function internalAddToFavourites(name, link, index) {
            var list = document.getElementById("favsBar");
            var li = document.createElement("LI");
            var div = document.createElement("DIV");
            var textNode = document.createTextNode(name);
            div.appendChild(textNode);
            div.setAttribute("class", "item");
            div.setAttribute("href", link);
            div.setAttribute("onclick", "clickedFavourite(this)");
            div.setAttribute("oncontextmenu", "removeFromBookmarks(this)");
            li.appendChild(div);
            li.setAttribute("class", "item");
            li.setAttribute("index", index);
            list.appendChild(li);
        }

       function removeFromStorage(item) {
           var index = item.getAttribute("index");
           currentData.favourites.splice(index, 1);
           localStorage.setItem("favourites-storage", JSON.stringify(currentData));
           console.log(currentData);
       }

        $(document).ready(function() {
            loadData();
        });

    </script>

    <div id="favourties">
        <ul id="favsBar"><li class="item"><div class="item" onclick="openAddMenu()">New bookmark</div></li></ul>
        <div id="inputForm">
            <div><span class="inputLabel">Link</span> <input id = "addToListLink" class="input102" placeholder="http://york.ca"></div>
            <div><span class="inputLabel">Name</span> <input id = "addToListName" class="input102" placeholder="York Region"></div>
            <div class="button" id="small" onclick="closeAddFavouritesMenu()">Cancel</div>
            <div class="button" onclick="addToFavourites()">Add to favourties</div>
        </div>
    </div>
</body>